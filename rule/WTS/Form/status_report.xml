<?xml version="1.0" encoding="windows-1251"?>
<rule type="form" id="status_report" mode="on">
	<description>Форма отчета</description>
	<xsltfile>forms/status_report.xsl</xsltfile>
	<outline>navigator</outline>
	<doctype>task</doctype>
	<showfile>true</showfile>
	<default>
		<action mode="on" type="SAVE">
			<caption source="KEYWORD">Сформировать отчет</caption>
			<granted source="macro" mode="on">current_user</granted>
		</action>
		<field mode="on">
			<name>close</name>
			<caption source="KEYWORD">Закрыть</caption>
		</field>
		<field mode="on">
			<name>allcontrol</name>
		</field>
		<field mode="on">
			<name>taskdate</name>
			<caption source="KEYWORD">Дата резолюции</caption>
		</field>
	</default>
	<show>
		<action mode="on" type="SAVE">
			<caption source="KEYWORD">Сохранить и закрыть</caption>
			<granted source="script" mode="on"><![CDATA[
				String[] getStringValue(_Document doc){
					return getAsArray(doc.getValueString('taskauthor'));
				}
				]]></granted>
		</action>
	</show>
	<save push="off" syncrule="kr">
	</save>
	<querysave><![CDATA[
		void doQuerySave(_Session ses, _Document doc, String user){
            def struct = ses.getStructure();
            def u = struct.getUser(doc.getValueString("taskauthor"));
            String sh = u.getShortName();
            def t = (_Task)doc;
            String rview = "";   
       		setRedirectView("report_tasks");
	}
	]]></querysave>
	<caption name="close" source="KEYWORD">Закрыть</caption>
	<caption name="properties" source="KEYWORD">Свойства</caption>
	<caption name="attachments" source="KEYWORD">Вложения</caption>
	<caption name="content" source="KEYWORD">Содержание</caption>
	<caption name="progress" source="KEYWORD">Ход исполнения</caption>
	<caption name="performer" source="KEYWORD">исполнитель</caption>
	<caption name="date" source="KEYWORD">дата</caption>
	<caption name="removedby" source="KEYWORD">кто снял</caption>
	<caption name="control" source="KEYWORD">Контроль</caption>
	<caption name="progress" source="KEYWORD">Ход исполнения</caption>
	<caption name="saved" source="KEYWORD">Сохраненный</caption>
	<caption name="newdoc" source="KEYWORD">Новый документ</caption>
	<caption name="editing" source="KEYWORD">Редактирование</caption>
	<caption name="readonly" source="KEYWORD">Только для чтения</caption>
	<caption name="modenotdefined" source="KEYWORD">Режим не определен</caption>
	<caption name="delattach" source="KEYWORD">Удалить</caption>
	<caption name="openattach" source="KEYWORD">Открыть</caption>
	<caption name="logout" source="KEYWORD">Завершить работу</caption>
	<caption name="help" source="KEYWORD">Помощь</caption>
	<caption name="appcaption" source="KEYWORD">Автоматизированная веб-система технического надзора (WTS)</caption>
	<caption name="curuserprop" source="KEYWORD">Посмотреть свойства текущего пользователя</caption>
	<caption name="documentsavedcaption" source="KEYWORD">Документ сохранен</caption>
	<caption name="documentmarkread" source="KEYWORD">Документ отмечен как прочтенный</caption>
	<caption name="pleasewaitdocsave" source="KEYWORD">Пожалуйста ждите... Идет сохранение документа</caption>
	<glossary mode="on" id="projectsprav" source="query">
		<description>Проект</description>
		<value>projectsprav</value>
	</glossary>
</rule>
